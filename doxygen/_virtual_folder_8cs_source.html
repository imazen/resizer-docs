<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>ImageResizer: C:/Users/Administrator/Documents/resizer/Core/Plugins/Basic/VirtualFolder.cs Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />

<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  <td id="projectlogo"><img alt="Logo" src="resizer-icon-64.png"/></td>
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">ImageResizer
   &#160;<span id="projectnumber">3.1.3</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">C:/Users/Administrator/Documents/resizer/Core/Plugins/Basic/VirtualFolder.cs</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 ï»¿using System;
<a name="l00002"></a>00002 <span class="keyword">using</span> System.Collections.Generic;
<a name="l00003"></a>00003 <span class="keyword">using</span> System.Text;
<a name="l00004"></a>00004 <span class="keyword">using</span> System.Web;
<a name="l00005"></a>00005 <span class="keyword">using</span> System.Security.Permissions;
<a name="l00006"></a>00006 <span class="keyword">using</span> System.Web.Hosting;
<a name="l00007"></a>00007 <span class="keyword">using</span> ImageResizer.Plugins;
<a name="l00008"></a>00008 <span class="keyword">using</span> ImageResizer.Configuration;
<a name="l00009"></a>00009 <span class="keyword">using</span> System.IO;
<a name="l00010"></a>00010 <span class="keyword">using</span> System.Web.Caching;
<a name="l00011"></a>00011 <span class="keyword">using</span> System.Collections.Specialized;
<a name="l00012"></a>00012 <span class="keyword">using</span> System.Security;
<a name="l00013"></a>00013 <span class="keyword">using</span> ImageResizer.Configuration.Issues;
<a name="l00014"></a>00014 
<a name="l00015"></a>00015 <span class="keyword">namespace </span>ImageResizer.Plugins.Basic {<span class="comment"></span>
<a name="l00016"></a>00016 <span class="comment">    /// &lt;summary&gt;</span>
<a name="l00017"></a>00017 <span class="comment">    /// Functions exactly like an IIS virtual folder, but doesn&#39;t require IIS configuration.</span>
<a name="l00018"></a>00018 <span class="comment">    /// &lt;/summary&gt;</span>
<a name="l00019"></a><a class="code" href="class_image_resizer_1_1_plugins_1_1_basic_1_1_virtual_folder.html">00019</a> <span class="comment"></span>    <span class="keyword">public</span> <span class="keyword">class </span><a class="code" href="class_image_resizer_1_1_plugins_1_1_basic_1_1_virtual_folder.html" title="Functions exactly like an IIS virtual folder, but doesn&#39;t require IIS configuration.">VirtualFolder</a> : VirtualPathProvider, <a class="code" href="interface_image_resizer_1_1_plugins_1_1_i_virtual_image_provider.html" title="Implement this to allow your class (or VirtualPathProvider subclass) to be used without registering i...">IVirtualImageProvider</a>, <a class="code" href="interface_image_resizer_1_1_plugins_1_1_i_plugin.html" title="All plugins must implement this. Enables web.config addition and removal.">IPlugin</a> , <a class="code" href="interface_image_resizer_1_1_plugins_1_1_i_multi_instance_plugin.html" title="Tag your plugin with this interface if it supports having multiple instances registered at once...">IMultiInstancePlugin</a>, <a class="code" href="interface_image_resizer_1_1_configuration_1_1_issues_1_1_i_issue_provider.html">IIssueProvider</a>{
<a name="l00020"></a>00020 
<a name="l00021"></a>00021         <span class="keyword">public</span> <a class="code" href="class_image_resizer_1_1_plugins_1_1_basic_1_1_virtual_folder.html" title="Functions exactly like an IIS virtual folder, but doesn&#39;t require IIS configuration.">VirtualFolder</a>(<span class="keywordtype">string</span> virtualPath, <span class="keywordtype">string</span> physicalPath)
<a name="l00022"></a>00022             : base() {
<a name="l00023"></a>00023             this.VirtualPath = virtualPath;
<a name="l00024"></a>00024             this.PhysicalPath = physicalPath;
<a name="l00025"></a>00025         }
<a name="l00026"></a>00026         <span class="keyword">public</span> <a class="code" href="class_image_resizer_1_1_plugins_1_1_basic_1_1_virtual_folder.html" title="Functions exactly like an IIS virtual folder, but doesn&#39;t require IIS configuration.">VirtualFolder</a>(<span class="keywordtype">string</span> virtualPath, <span class="keywordtype">string</span> physicalPath, <span class="keywordtype">bool</span> registerAsVpp)
<a name="l00027"></a>00027             : base() {
<a name="l00028"></a>00028             this.VirtualPath = virtualPath;
<a name="l00029"></a>00029             this.PhysicalPath = physicalPath;
<a name="l00030"></a>00030             this.RegisterAsVpp = registerAsVpp;
<a name="l00031"></a>00031         }
<a name="l00032"></a>00032 
<a name="l00033"></a>00033         <span class="keyword">public</span> <a class="code" href="class_image_resizer_1_1_plugins_1_1_basic_1_1_virtual_folder.html" title="Functions exactly like an IIS virtual folder, but doesn&#39;t require IIS configuration.">VirtualFolder</a>(NameValueCollection args)
<a name="l00034"></a>00034             : base() {
<a name="l00035"></a>00035             this.VirtualPath = args[<span class="stringliteral">&quot;virtualPath&quot;</span>];
<a name="l00036"></a>00036             this.PhysicalPath = args[<span class="stringliteral">&quot;physicalPath&quot;</span>];
<a name="l00037"></a>00037             this.RegisterAsVpp = Util.Utils.getBool(args, <span class="stringliteral">&quot;vpp&quot;</span>, this.RegisterAsVpp);
<a name="l00038"></a>00038         }
<a name="l00039"></a>00039 
<a name="l00040"></a>00040 
<a name="l00041"></a>00041 
<a name="l00042"></a>00042         <span class="keyword">private</span> <span class="keywordtype">bool</span> _failedToRegisterVpp = <span class="keyword">false</span>;<span class="comment"></span>
<a name="l00043"></a>00043 <span class="comment">        /// &lt;summary&gt;</span>
<a name="l00044"></a>00044 <span class="comment">        /// True if the provider attempted to register itself as a VirtualPathProvider and failed due to limited security clearance.</span>
<a name="l00045"></a>00045 <span class="comment">        /// False if it did not attempt (say, due to missing IOPermission) , or if it succeeded.</span>
<a name="l00046"></a>00046 <span class="comment">        /// &lt;/summary&gt;</span>
<a name="l00047"></a><a class="code" href="class_image_resizer_1_1_plugins_1_1_basic_1_1_virtual_folder.html#aea46e733ffc529cfa7136a2e48fe779d">00047</a> <span class="comment"></span>        <span class="keyword">public</span> <span class="keywordtype">bool</span> FailedToRegisterVpp {
<a name="l00048"></a>00048             <span class="keyword">get</span> { <span class="keywordflow">return</span> _failedToRegisterVpp; }
<a name="l00049"></a>00049         }
<a name="l00050"></a>00050 
<a name="l00051"></a>00051         <span class="keyword">private</span> <span class="keywordtype">bool</span> registerAsVpp = <span class="keyword">true</span>;<span class="comment"></span>
<a name="l00052"></a>00052 <span class="comment">        /// &lt;summary&gt;</span>
<a name="l00053"></a>00053 <span class="comment">        /// If true, the plugin will attempt to register itself as an application-wide VirtualPathProvider instead of a image resizer-specific IVirtualImageProvider.</span>
<a name="l00054"></a>00054 <span class="comment">        /// &lt;/summary&gt;</span>
<a name="l00055"></a><a class="code" href="class_image_resizer_1_1_plugins_1_1_basic_1_1_virtual_folder.html#a86a0f4d2cd650294499895a18d407c05">00055</a> <span class="comment"></span>        <span class="keyword">public</span> <span class="keywordtype">bool</span> RegisterAsVpp {
<a name="l00056"></a>00056             <span class="keyword">get</span> { <span class="keywordflow">return</span> registerAsVpp; }
<a name="l00057"></a>00057             <span class="keyword">set</span> { registerAsVpp = value; }
<a name="l00058"></a>00058         }
<a name="l00059"></a>00059 
<a name="l00060"></a>00060         <span class="keyword">private</span> <span class="keywordtype">string</span> virtualPath = null;<span class="comment"></span>
<a name="l00061"></a>00061 <span class="comment">        /// &lt;summary&gt;</span>
<a name="l00062"></a>00062 <span class="comment">        /// The virtual path served by the VirtualFolder</span>
<a name="l00063"></a>00063 <span class="comment">        /// &lt;/summary&gt;</span>
<a name="l00064"></a><a class="code" href="class_image_resizer_1_1_plugins_1_1_basic_1_1_virtual_folder.html#ab0c6a53316642080d5500c7a656f16e7">00064</a> <span class="comment"></span>        <span class="keyword">public</span> <span class="keywordtype">string</span> VirtualPath {
<a name="l00065"></a>00065             <span class="keyword">get</span> { <span class="keywordflow">return</span> virtualPath; }
<a name="l00066"></a>00066             <span class="keyword">set</span> { virtualPath = normalizeVirtualPath(value); }
<a name="l00067"></a>00067         }
<a name="l00068"></a>00068 
<a name="l00069"></a>00069         <span class="keyword">private</span> <span class="keywordtype">string</span> physicalPath = null;<span class="comment"></span>
<a name="l00070"></a>00070 <span class="comment">        /// &lt;summary&gt;</span>
<a name="l00071"></a>00071 <span class="comment">        /// The physical path</span>
<a name="l00072"></a>00072 <span class="comment">        /// &lt;/summary&gt;</span>
<a name="l00073"></a><a class="code" href="class_image_resizer_1_1_plugins_1_1_basic_1_1_virtual_folder.html#a8acf5f07add4086166790d079740e95e">00073</a> <span class="comment"></span>        <span class="keyword">public</span> <span class="keywordtype">string</span> PhysicalPath {
<a name="l00074"></a>00074             <span class="keyword">get</span> { <span class="keywordflow">return</span> physicalPath; }
<a name="l00075"></a>00075             <span class="keyword">set</span> { physicalPath = resolvePhysicalPath(value); }
<a name="l00076"></a>00076         }
<a name="l00077"></a>00077 
<a name="l00078"></a>00078 
<a name="l00079"></a>00079         <span class="keyword">private</span> <span class="keywordtype">bool</span> registeredVpp = <span class="keyword">false</span>;<span class="comment"></span>
<a name="l00080"></a>00080 <span class="comment">        /// &lt;summary&gt;</span>
<a name="l00081"></a>00081 <span class="comment">        /// Registers the VirtualFolder plugin as a virtual path provider.</span>
<a name="l00082"></a>00082 <span class="comment">        /// &lt;/summary&gt;</span>
<a name="l00083"></a>00083 <span class="comment">        /// &lt;returns&gt;&lt;/returns&gt;</span>
<a name="l00084"></a><a class="code" href="class_image_resizer_1_1_plugins_1_1_basic_1_1_virtual_folder.html#a9761b1a23ef4918aaac5ee68fee6ec33">00084</a> <span class="comment"></span>        <span class="keyword">public</span> <a class="code" href="interface_image_resizer_1_1_plugins_1_1_i_plugin.html" title="All plugins must implement this. Enables web.config addition and removal.">IPlugin</a> <a class="code" href="class_image_resizer_1_1_plugins_1_1_basic_1_1_virtual_folder.html#a9761b1a23ef4918aaac5ee68fee6ec33" title="Registers the VirtualFolder plugin as a virtual path provider.">Install</a>(<a class="code" href="class_image_resizer_1_1_configuration_1_1_config.html">Config</a> c) {
<a name="l00085"></a>00085             <span class="keywordflow">if</span> (!NoIOPermission &amp;&amp; RegisterAsVpp) {
<a name="l00086"></a>00086                 <span class="keywordflow">try</span> {
<a name="l00087"></a>00087                     HostingEnvironment.RegisterVirtualPathProvider(<span class="keyword">this</span>);
<a name="l00088"></a>00088                     registeredVpp = <span class="keyword">true</span>;
<a name="l00089"></a>00089                 } <span class="keywordflow">catch</span> (SecurityException) {
<a name="l00090"></a>00090                     this._failedToRegisterVpp =<span class="keyword">true</span>;
<a name="l00091"></a>00091                 }
<a name="l00092"></a>00092             }
<a name="l00093"></a>00093             c.<a class="code" href="class_image_resizer_1_1_configuration_1_1_config.html#aa8cdada7d657ec3078e5d16310f198f7" title="Access and modify plugins.">Plugins</a>.<a class="code" href="class_image_resizer_1_1_configuration_1_1_plugin_config.html#a24a5d36dc59eee7d980a8e9b4d00ead1" title="Only for use by plugins during IPlugin.Install. Call Plugin.Install instead of this method...">add_plugin</a>(<span class="keyword">this</span>);
<a name="l00094"></a>00094             <span class="keywordflow">return</span> <span class="keyword">this</span>;
<a name="l00095"></a>00095         }
<a name="l00096"></a><a class="code" href="class_image_resizer_1_1_plugins_1_1_basic_1_1_virtual_folder.html#a492853a24151106234ba0dad23d6aaf2">00096</a>         <span class="keyword">public</span> <span class="keywordtype">bool</span> <a class="code" href="class_image_resizer_1_1_plugins_1_1_basic_1_1_virtual_folder.html#a492853a24151106234ba0dad23d6aaf2" title="Uninstalls the plugin. Should reverse all changes made during Install.">Uninstall</a>(<a class="code" href="class_image_resizer_1_1_configuration_1_1_config.html">Config</a> c) {
<a name="l00097"></a>00097             c.<a class="code" href="class_image_resizer_1_1_configuration_1_1_config.html#aa8cdada7d657ec3078e5d16310f198f7" title="Access and modify plugins.">Plugins</a>.<a class="code" href="class_image_resizer_1_1_configuration_1_1_plugin_config.html#a0aae69c8ce761b0b5869fd63e2bcb863" title="For use only by plugins during .Uninstall. Removes the specified plugin from AllPlugins, QuerystringPlugins, CachingSystems, ImageEncoders, and ImageBuiderExtensions, based on which interfaces the instance implements. Plugins may register event handlers and modify settings - thus you should use the plugin&#39;s method to uninstall them vs. using this method.">remove_plugin</a>(<span class="keyword">this</span>);
<a name="l00098"></a>00098             <span class="keywordflow">return</span> !registeredVpp;<span class="comment">//Cannot truly remove a VPP</span>
<a name="l00099"></a>00099         }
<a name="l00100"></a>00100 
<a name="l00101"></a>00101         <span class="keyword">private</span> <span class="keywordtype">bool</span> noIOPermission = <span class="keyword">false</span>;<span class="comment"></span>
<a name="l00102"></a>00102 <span class="comment">        /// &lt;summary&gt;</span>
<a name="l00103"></a>00103 <span class="comment">        /// True if the plugin has detected it doesn&#39;t have sufficient IOPermission to operate.</span>
<a name="l00104"></a>00104 <span class="comment">        /// &lt;/summary&gt;</span>
<a name="l00105"></a><a class="code" href="class_image_resizer_1_1_plugins_1_1_basic_1_1_virtual_folder.html#ab8bd68930f844ef5350cb7424d453715">00105</a> <span class="comment"></span>        <span class="keyword">public</span> <span class="keywordtype">bool</span> NoIOPermission {
<a name="l00106"></a>00106             <span class="keyword">get</span> { <span class="keywordflow">return</span> noIOPermission; }
<a name="l00107"></a>00107         }
<a name="l00108"></a>00108 
<a name="l00109"></a>00109 
<a name="l00110"></a>00110         <span class="keyword">protected</span> <span class="keywordtype">string</span> normalizeVirtualPath(<span class="keywordtype">string</span> path) {
<a name="l00111"></a>00111             <span class="keywordflow">if</span> (!path.StartsWith(<span class="stringliteral">&quot;/&quot;</span>)) path = HostingEnvironment.ApplicationVirtualPath.TrimEnd(<span class="charliteral">&#39;/&#39;</span>) + <span class="charliteral">&#39;/&#39;</span> + path.Substring(1).TrimStart(<span class="charliteral">&#39;/&#39;</span>);
<a name="l00112"></a>00112             <span class="keywordflow">return</span> path;
<a name="l00113"></a>00113         }
<a name="l00114"></a>00114 
<a name="l00115"></a>00115         <span class="keyword">protected</span> <span class="keywordtype">string</span> resolvePhysicalPath(<span class="keywordtype">string</span> path) {
<a name="l00116"></a>00116             
<a name="l00117"></a>00117             <span class="keywordflow">if</span> (!Path.IsPathRooted(path)) path = Path.Combine(HostingEnvironment.ApplicationPhysicalPath, path);
<a name="l00118"></a>00118             <span class="keywordflow">if</span> (NoIOPermission) <span class="keywordflow">return</span> collapsePath(path);
<a name="l00119"></a>00119 
<a name="l00120"></a>00120             <span class="keywordflow">try</span> {
<a name="l00121"></a>00121                 <span class="keywordflow">return</span> Path.GetFullPath(path);
<a name="l00122"></a>00122             } <span class="keywordflow">catch</span> (SecurityException) {
<a name="l00123"></a>00123                 noIOPermission = <span class="keyword">true</span>;
<a name="l00124"></a>00124                 <span class="keywordflow">return</span> collapsePath(path);
<a name="l00125"></a>00125             }
<a name="l00126"></a>00126         }
<a name="l00127"></a>00127 
<a name="l00128"></a>00128         <span class="keyword">protected</span> <span class="keywordtype">string</span> collapsePath(<span class="keywordtype">string</span> path) {
<a name="l00129"></a>00129             <span class="keywordtype">string</span> oldPath = path;
<a name="l00130"></a>00130             <span class="keywordflow">do</span> {
<a name="l00131"></a>00131                 oldPath = path;
<a name="l00132"></a>00132                 path = collapseOneLevel(oldPath);
<a name="l00133"></a>00133             } <span class="keywordflow">while</span> (oldPath != path);
<a name="l00134"></a>00134             <span class="keywordflow">return</span> path;
<a name="l00135"></a>00135         }
<a name="l00136"></a>00136 
<a name="l00137"></a>00137         <span class="keyword">protected</span> <span class="keywordtype">string</span> collapseOneLevel(<span class="keywordtype">string</span> path) {
<a name="l00138"></a>00138             <span class="keywordtype">int</span> up = path.Length - 1;
<a name="l00139"></a>00139             <span class="keywordflow">do</span> {
<a name="l00140"></a>00140                 up = path.LastIndexOf(System.IO.Path.DirectorySeparatorChar + <span class="stringliteral">&quot;..&quot;</span> + System.IO.Path.DirectorySeparatorChar, up);
<a name="l00141"></a>00141                 <span class="keywordflow">if</span> (up &lt; 0) <span class="keywordflow">return</span> path;
<a name="l00142"></a>00142                 <span class="keywordtype">int</span> prevSlash = path.LastIndexOf(System.IO.Path.DirectorySeparatorChar, up - 1);
<a name="l00143"></a>00143                 <span class="keywordflow">if</span> (prevSlash &lt; 0) <span class="keywordflow">return</span> path;
<a name="l00144"></a>00144                 <span class="keywordtype">string</span> segment = path.Substring(prevSlash + 1, up - prevSlash - 1);
<a name="l00145"></a>00145                 <span class="keywordflow">if</span> (segment.Equals(<span class="stringliteral">&quot;..&quot;</span>, StringComparison.OrdinalIgnoreCase)) {
<a name="l00146"></a>00146                     <span class="comment">//We can&#39;t combine \..\..\, just keep looking closer to the beginning of the string. We already adjusted &#39;up&#39;</span>
<a name="l00147"></a>00147                 } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (segment.Equals(<span class="stringliteral">&quot;.&quot;</span>, StringComparison.OrdinalIgnoreCase)) {
<a name="l00148"></a>00148                     <span class="keywordflow">return</span> path.Substring(0, prevSlash) + path.Substring(up); <span class="comment">//Just remove \.\ sections</span>
<a name="l00149"></a>00149                 } <span class="keywordflow">else</span> {
<a name="l00150"></a>00150                     <span class="keywordflow">return</span> path.Substring(0, prevSlash) + path.Substring(up + 3); <span class="comment">//If it&#39;s not \.\ or \..\, remove both it and the following \..\</span>
<a name="l00151"></a>00151 <span class="comment">                }</span>
<a name="l00152"></a>00152             } <span class="keywordflow">while</span> (up &gt; 0);
<a name="l00153"></a>00153             <span class="keywordflow">return</span> path;
<a name="l00154"></a>00154         }<span class="comment"></span>
<a name="l00155"></a>00155 <span class="comment">        /// &lt;summary&gt;</span>
<a name="l00156"></a>00156 <span class="comment">        /// Converts a virtual path in this folder to a physical path. Returns null if the virtual path is outside the folder.</span>
<a name="l00157"></a>00157 <span class="comment">        /// &lt;/summary&gt;</span>
<a name="l00158"></a>00158 <span class="comment">        /// &lt;param name=&quot;virtualPath&quot;&gt;&lt;/param&gt;</span>
<a name="l00159"></a>00159 <span class="comment">        /// &lt;returns&gt;&lt;/returns&gt;</span>
<a name="l00160"></a><a class="code" href="class_image_resizer_1_1_plugins_1_1_basic_1_1_virtual_folder.html#a93714723aad0fcc7834e3249ef326282">00160</a> <span class="comment"></span>        <span class="keyword">public</span> <span class="keywordtype">string</span> <a class="code" href="class_image_resizer_1_1_plugins_1_1_basic_1_1_virtual_folder.html#a93714723aad0fcc7834e3249ef326282" title="Converts a virtual path in this folder to a physical path. Returns null if the virtual path is outsid...">VirtualToPhysical</a>(<span class="keywordtype">string</span> virtualPath) {
<a name="l00161"></a>00161             virtualPath = normalizeVirtualPath(virtualPath);
<a name="l00162"></a>00162             <span class="keywordflow">if</span> (virtualPath.StartsWith(<span class="keyword">this</span>.VirtualPath, StringComparison.OrdinalIgnoreCase)) {
<a name="l00163"></a>00163                 <span class="keywordflow">return</span> Path.Combine(PhysicalPath, virtualPath.Substring(<span class="keyword">this</span>.VirtualPath.Length).TrimStart(<span class="charliteral">&#39;/&#39;</span>).Replace(<span class="charliteral">&#39;/&#39;</span>, Path.DirectorySeparatorChar));
<a name="l00164"></a>00164             }
<a name="l00165"></a>00165             <span class="keywordflow">return</span> null;
<a name="l00166"></a>00166         }<span class="comment"></span>
<a name="l00167"></a>00167 <span class="comment">        /// &lt;summary&gt;</span>
<a name="l00168"></a>00168 <span class="comment">        /// Returns true if the specified path is inside this virtual folder</span>
<a name="l00169"></a>00169 <span class="comment">        /// &lt;/summary&gt;</span>
<a name="l00170"></a>00170 <span class="comment">        /// &lt;param name=&quot;virtualPath&quot;&gt;&lt;/param&gt;</span>
<a name="l00171"></a>00171 <span class="comment">        /// &lt;returns&gt;&lt;/returns&gt;</span>
<a name="l00172"></a><a class="code" href="class_image_resizer_1_1_plugins_1_1_basic_1_1_virtual_folder.html#ae5dae2cdf6772f6f585f13ff0464a67f">00172</a> <span class="comment"></span>        <span class="keyword">public</span> <span class="keywordtype">bool</span> <a class="code" href="class_image_resizer_1_1_plugins_1_1_basic_1_1_virtual_folder.html#ae5dae2cdf6772f6f585f13ff0464a67f" title="Returns true if the specified path is inside this virtual folder.">IsVirtualPath</a>(<span class="keywordtype">string</span> virtualPath) {
<a name="l00173"></a>00173             virtualPath = normalizeVirtualPath(virtualPath);
<a name="l00174"></a>00174             <span class="keywordflow">return</span> virtualPath.StartsWith(this.VirtualPath, StringComparison.OrdinalIgnoreCase);
<a name="l00175"></a>00175         }
<a name="l00176"></a>00176         <span class="keyword">private</span> <span class="keywordtype">bool</span> isOnlyVirtualPath(<span class="keywordtype">string</span> virtualPath) {
<a name="l00177"></a>00177             <span class="keywordflow">if</span> (NoIOPermission) <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">//Don&#39;t act as a VPP if we don&#39;t have permission to operate.</span>
<a name="l00178"></a>00178             <span class="keywordflow">if</span> (Previous.FileExists(virtualPath)) <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00179"></a>00179             <span class="keywordflow">return</span> IsVirtualPath(virtualPath);
<a name="l00180"></a>00180         }
<a name="l00181"></a>00181 
<a name="l00182"></a>00182 
<a name="l00183"></a>00183 
<a name="l00184"></a>00184         <span class="keyword">internal</span> <span class="keyword">protected</span> Stream getStream(<span class="keywordtype">string</span> virtualPath) {
<a name="l00185"></a>00185             <span class="keywordflow">if</span> (isOnlyVirtualPath(virtualPath))
<a name="l00186"></a>00186                 <span class="keywordflow">return</span> File.Open(VirtualToPhysical(virtualPath), FileMode.Open, FileAccess.Read, FileShare.Read);
<a name="l00187"></a>00187             <span class="keywordflow">return</span> null;
<a name="l00188"></a>00188         }<span class="comment"></span>
<a name="l00189"></a>00189 <span class="comment">        /// &lt;summary&gt;</span>
<a name="l00190"></a>00190 <span class="comment">        /// Returns the LastWriteTimeUtc value for the specified virtual file in this folder, or DateTime.MinValue if missing.</span>
<a name="l00191"></a>00191 <span class="comment">        /// &lt;/summary&gt;</span>
<a name="l00192"></a>00192 <span class="comment">        /// &lt;param name=&quot;virtualPath&quot;&gt;&lt;/param&gt;</span>
<a name="l00193"></a>00193 <span class="comment">        /// &lt;returns&gt;&lt;/returns&gt;</span>
<a name="l00194"></a><a class="code" href="class_image_resizer_1_1_plugins_1_1_basic_1_1_virtual_folder.html#a7568a5fec26644bc3fc8e9c6c62e3d21">00194</a> <span class="comment"></span>        <span class="keyword">public</span> DateTime <a class="code" href="class_image_resizer_1_1_plugins_1_1_basic_1_1_virtual_folder.html#a7568a5fec26644bc3fc8e9c6c62e3d21" title="Returns the LastWriteTimeUtc value for the specified virtual file in this folder, or DateTime...">GetDateModifiedUtc</a>(<span class="keywordtype">string</span> virtualPath) {
<a name="l00195"></a>00195             <span class="keywordtype">string</span> physicalPath = VirtualToPhysical(virtualPath);
<a name="l00196"></a>00196             <span class="keywordflow">if</span> (System.IO.File.Exists(physicalPath))
<a name="l00197"></a>00197                 <span class="keywordflow">return</span> System.IO.File.GetLastWriteTimeUtc(physicalPath);
<a name="l00198"></a>00198             <span class="keywordflow">else</span> <span class="keywordflow">return</span> DateTime.MinValue;
<a name="l00199"></a>00199         }
<a name="l00200"></a>00200 <span class="comment"></span>
<a name="l00201"></a>00201 <span class="comment">        /// &lt;summary&gt;</span>
<a name="l00202"></a>00202 <span class="comment">        /// Returns true if the file exists in this virtual folder, and would not be masking an existing file.</span>
<a name="l00203"></a>00203 <span class="comment">        /// Returns false if NoIOPermission is true.</span>
<a name="l00204"></a>00204 <span class="comment">        /// &lt;/summary&gt;</span>
<a name="l00205"></a>00205 <span class="comment">        /// &lt;param name=&quot;virtualPath&quot;&gt;&lt;/param&gt;</span>
<a name="l00206"></a>00206 <span class="comment">        /// &lt;param name=&quot;queryString&quot;&gt;&lt;/param&gt;</span>
<a name="l00207"></a>00207 <span class="comment">        /// &lt;returns&gt;&lt;/returns&gt;</span>
<a name="l00208"></a><a class="code" href="class_image_resizer_1_1_plugins_1_1_basic_1_1_virtual_folder.html#aa42b7d6fda2cea008cec82fae9627a9c">00208</a> <span class="comment"></span>        <span class="keyword">public</span> <span class="keywordtype">bool</span> <a class="code" href="class_image_resizer_1_1_plugins_1_1_basic_1_1_virtual_folder.html#aa42b7d6fda2cea008cec82fae9627a9c" title="Returns true if the file exists in this virtual folder, and would not be masking an existing file...">FileExists</a>(<span class="keywordtype">string</span> virtualPath, NameValueCollection queryString) {
<a name="l00209"></a>00209             <span class="keywordflow">if</span> (NoIOPermission) <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">//Because File.Exists is always false when IOPermission is missing, anyhow.</span>
<a name="l00210"></a>00210             <span class="keywordflow">if</span> (!IsVirtualPath(virtualPath)) <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">//It&#39;s not even in our area.</span>
<a name="l00211"></a>00211             <span class="keywordflow">if</span> (File.Exists(VirtualToPhysical(virtualPath))){
<a name="l00212"></a>00212                 <span class="comment">//Ok, we could serve it, but existing files take precedence.</span>
<a name="l00213"></a>00213                 <span class="comment">//Return false if we would be masking an existing file.</span>
<a name="l00214"></a>00214                 <span class="keywordflow">return</span> !File.Exists(HostingEnvironment.MapPath(normalizeVirtualPath(virtualPath)));
<a name="l00215"></a>00215             }
<a name="l00216"></a>00216             <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00217"></a>00217         }<span class="comment"></span>
<a name="l00218"></a>00218 <span class="comment">        /// &lt;summary&gt;</span>
<a name="l00219"></a>00219 <span class="comment">        /// Unless the path is not within the virtual folder, or IO permissions are missing, will return an IVirtualFile instance for the path. </span>
<a name="l00220"></a>00220 <span class="comment">        /// The file may or may not exist.</span>
<a name="l00221"></a>00221 <span class="comment">        /// &lt;/summary&gt;</span>
<a name="l00222"></a>00222 <span class="comment">        /// &lt;param name=&quot;virtualPath&quot;&gt;&lt;/param&gt;</span>
<a name="l00223"></a>00223 <span class="comment">        /// &lt;param name=&quot;queryString&quot;&gt;&lt;/param&gt;</span>
<a name="l00224"></a>00224 <span class="comment">        /// &lt;returns&gt;&lt;/returns&gt;</span>
<a name="l00225"></a><a class="code" href="class_image_resizer_1_1_plugins_1_1_basic_1_1_virtual_folder.html#a8d84bd2a87ff405820e55918947153c3">00225</a> <span class="comment"></span>        <span class="keyword">public</span> <a class="code" href="interface_image_resizer_1_1_plugins_1_1_i_virtual_file.html" title="A virtual file. Implementing this allows usage of your VirtualProvider without registering it with AS...">IVirtualFile</a> <a class="code" href="class_image_resizer_1_1_plugins_1_1_basic_1_1_virtual_folder.html#a8d84bd2a87ff405820e55918947153c3" title="Unless the path is not within the virtual folder, or IO permissions are missing, will return an IVirt...">GetFile</a>(<span class="keywordtype">string</span> virtualPath, NameValueCollection queryString) {
<a name="l00226"></a>00226             <span class="keywordflow">if</span> (NoIOPermission) <span class="keywordflow">return</span> null;
<a name="l00227"></a>00227             <span class="keywordflow">if</span> (!IsVirtualPath(virtualPath)) <span class="keywordflow">return</span> null; <span class="comment">//It&#39;s not even in our area.</span>
<a name="l00228"></a>00228             <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="class_image_resizer_1_1_plugins_1_1_basic_1_1_virtual_folder_1_1_virtual_folder_provider_virtual_file.html">VirtualFolderProviderVirtualFile</a>(virtualPath, <span class="keyword">this</span>);
<a name="l00229"></a>00229         }
<a name="l00230"></a>00230 <span class="comment"></span>
<a name="l00231"></a>00231 <span class="comment">        /// &lt;summary&gt;</span>
<a name="l00232"></a>00232 <span class="comment">        /// For internal use only by the .NET VPP system.</span>
<a name="l00233"></a>00233 <span class="comment">        /// &lt;/summary&gt;</span>
<a name="l00234"></a>00234 <span class="comment">        /// &lt;param name=&quot;virtualPath&quot;&gt;&lt;/param&gt;</span>
<a name="l00235"></a>00235 <span class="comment">        /// &lt;returns&gt;&lt;/returns&gt;</span>
<a name="l00236"></a><a class="code" href="class_image_resizer_1_1_plugins_1_1_basic_1_1_virtual_folder.html#a0b8f145683df85bb4b0032a21ebc52b5">00236</a> <span class="comment"></span>        <span class="keyword">public</span> <span class="keyword">override</span> <span class="keywordtype">bool</span> <a class="code" href="class_image_resizer_1_1_plugins_1_1_basic_1_1_virtual_folder.html#a0b8f145683df85bb4b0032a21ebc52b5" title="For internal use only by the .NET VPP system.">FileExists</a>(<span class="keywordtype">string</span> virtualPath) {
<a name="l00237"></a>00237             <span class="keywordflow">if</span> (isOnlyVirtualPath(virtualPath))
<a name="l00238"></a>00238                 <span class="keywordflow">return</span> File.Exists(VirtualToPhysical(virtualPath));
<a name="l00239"></a>00239             <span class="keywordflow">else</span>
<a name="l00240"></a>00240                 <span class="keywordflow">return</span> Previous.FileExists(virtualPath);
<a name="l00241"></a>00241         }<span class="comment"></span>
<a name="l00242"></a>00242 <span class="comment">        /// &lt;summary&gt;</span>
<a name="l00243"></a>00243 <span class="comment">        /// For internal use only by the .NET VPP system.</span>
<a name="l00244"></a>00244 <span class="comment">        /// &lt;/summary&gt;</span>
<a name="l00245"></a>00245 <span class="comment">        /// &lt;param name=&quot;virtualPath&quot;&gt;&lt;/param&gt;</span>
<a name="l00246"></a>00246 <span class="comment">        /// &lt;returns&gt;&lt;/returns&gt;</span>
<a name="l00247"></a><a class="code" href="class_image_resizer_1_1_plugins_1_1_basic_1_1_virtual_folder.html#a1f1a914f95f86f6938c04911df01abdf">00247</a> <span class="comment"></span>        <span class="keyword">public</span> <span class="keyword">override</span> VirtualFile <a class="code" href="class_image_resizer_1_1_plugins_1_1_basic_1_1_virtual_folder.html#a1f1a914f95f86f6938c04911df01abdf" title="For internal use only by the .NET VPP system.">GetFile</a>(<span class="keywordtype">string</span> virtualPath) {
<a name="l00248"></a>00248             <span class="keywordflow">if</span> (isOnlyVirtualPath(virtualPath))
<a name="l00249"></a>00249                 <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="class_image_resizer_1_1_plugins_1_1_basic_1_1_virtual_folder_1_1_virtual_folder_provider_virtual_file.html">VirtualFolderProviderVirtualFile</a>(virtualPath, <span class="keyword">this</span>);
<a name="l00250"></a>00250             <span class="keywordflow">else</span>
<a name="l00251"></a>00251                 <span class="keywordflow">return</span> Previous.GetFile(virtualPath);
<a name="l00252"></a>00252         }<span class="comment"></span>
<a name="l00253"></a>00253 <span class="comment">        /// &lt;summary&gt;</span>
<a name="l00254"></a>00254 <span class="comment">        /// For internal use only by the .NET VPP system.</span>
<a name="l00255"></a>00255 <span class="comment">        /// &lt;/summary&gt;</span>
<a name="l00256"></a>00256 <span class="comment">        /// &lt;param name=&quot;virtualPath&quot;&gt;&lt;/param&gt;</span>
<a name="l00257"></a>00257 <span class="comment">        /// &lt;param name=&quot;virtualPathDependencies&quot;&gt;&lt;/param&gt;</span>
<a name="l00258"></a>00258 <span class="comment">        /// &lt;param name=&quot;utcStart&quot;&gt;&lt;/param&gt;</span>
<a name="l00259"></a>00259 <span class="comment">        /// &lt;returns&gt;&lt;/returns&gt;</span>
<a name="l00260"></a><a class="code" href="class_image_resizer_1_1_plugins_1_1_basic_1_1_virtual_folder.html#aa8449c161a0096606f0dbbfe7556e17d">00260</a> <span class="comment"></span>        <span class="keyword">public</span> <span class="keyword">override</span> CacheDependency GetCacheDependency(
<a name="l00261"></a>00261           <span class="keywordtype">string</span> virtualPath,
<a name="l00262"></a>00262           System.Collections.IEnumerable virtualPathDependencies,
<a name="l00263"></a>00263           DateTime utcStart) {
<a name="l00264"></a>00264 
<a name="l00265"></a>00265               <span class="keywordflow">if</span> (!isOnlyVirtualPath(virtualPath)) <span class="keywordflow">return</span> Previous.GetCacheDependency(virtualPath, virtualPathDependencies, utcStart);
<a name="l00266"></a>00266 
<a name="l00267"></a>00267             List&lt;String&gt; deps = <span class="keyword">new</span> List&lt;string&gt;();
<a name="l00268"></a>00268             <span class="keywordflow">foreach</span> (<span class="keywordtype">string</span> s <span class="keywordflow">in</span> virtualPathDependencies) {
<a name="l00269"></a>00269                 deps.Add(s);
<a name="l00270"></a>00270             }
<a name="l00271"></a>00271 
<a name="l00272"></a>00272 
<a name="l00273"></a>00273              <span class="keywordflow">return</span> <span class="keyword">new</span> CacheDependency(<span class="keyword">new</span> <span class="keywordtype">string</span>[] { VirtualToPhysical(virtualPath) }, deps.ToArray(), utcStart);
<a name="l00274"></a>00274 
<a name="l00275"></a>00275         }
<a name="l00276"></a>00276 
<a name="l00277"></a><a class="code" href="class_image_resizer_1_1_plugins_1_1_basic_1_1_virtual_folder_1_1_virtual_folder_provider_virtual_file.html">00277</a>         <span class="keyword">public</span> <span class="keyword">class </span><a class="code" href="class_image_resizer_1_1_plugins_1_1_basic_1_1_virtual_folder_1_1_virtual_folder_provider_virtual_file.html">VirtualFolderProviderVirtualFile</a> : VirtualFile, <a class="code" href="interface_image_resizer_1_1_plugins_1_1_i_virtual_file_with_modified_date.html" title="Always implement this if possible. Allows caching systems to detect changes to source files and inval...">IVirtualFileWithModifiedDate</a>, <a class="code" href="interface_image_resizer_1_1_plugins_1_1_i_virtual_file.html" title="A virtual file. Implementing this allows usage of your VirtualProvider without registering it with AS...">IVirtualFile</a> {
<a name="l00278"></a>00278 
<a name="l00279"></a>00279             <span class="keyword">private</span> <a class="code" href="class_image_resizer_1_1_plugins_1_1_basic_1_1_virtual_folder.html" title="Functions exactly like an IIS virtual folder, but doesn&#39;t require IIS configuration.">VirtualFolder</a> provider;
<a name="l00280"></a>00280 
<a name="l00281"></a>00281             <span class="keyword">private</span> Nullable&lt;bool&gt; _exists = null;
<a name="l00282"></a>00282             <span class="keyword">private</span> Nullable&lt;DateTime&gt; _fileModifiedDate = null;
<a name="l00283"></a>00283 
<a name="l00284"></a>00284             <span class="keyword">public</span> <span class="keywordtype">bool</span> Exists {
<a name="l00285"></a>00285                 <span class="keyword">get</span> {
<a name="l00286"></a>00286                     <span class="keywordflow">if</span> (_exists == null) _exists = provider.<a class="code" href="class_image_resizer_1_1_plugins_1_1_basic_1_1_virtual_folder.html#aa42b7d6fda2cea008cec82fae9627a9c" title="Returns true if the file exists in this virtual folder, and would not be masking an existing file...">FileExists</a>(this.VirtualPath);
<a name="l00287"></a>00287                     <span class="keywordflow">return</span> _exists.Value;
<a name="l00288"></a>00288                 }
<a name="l00289"></a>00289             }
<a name="l00290"></a>00290 
<a name="l00291"></a>00291             <span class="keyword">public</span> <a class="code" href="class_image_resizer_1_1_plugins_1_1_basic_1_1_virtual_folder_1_1_virtual_folder_provider_virtual_file.html">VirtualFolderProviderVirtualFile</a>(<span class="keywordtype">string</span> virtualPath, <a class="code" href="class_image_resizer_1_1_plugins_1_1_basic_1_1_virtual_folder.html" title="Functions exactly like an IIS virtual folder, but doesn&#39;t require IIS configuration.">VirtualFolder</a> provider)
<a name="l00292"></a>00292                 : base(virtualPath) {
<a name="l00293"></a>00293                 this.provider = provider;
<a name="l00294"></a>00294             }
<a name="l00295"></a>00295 
<a name="l00296"></a><a class="code" href="class_image_resizer_1_1_plugins_1_1_basic_1_1_virtual_folder_1_1_virtual_folder_provider_virtual_file.html#adde5c3a6b32de48e366fa301a6b9144f">00296</a>             <span class="keyword">public</span> <span class="keyword">override</span> Stream <a class="code" href="class_image_resizer_1_1_plugins_1_1_basic_1_1_virtual_folder_1_1_virtual_folder_provider_virtual_file.html#adde5c3a6b32de48e366fa301a6b9144f" title="Returns an opened stream to the file contents.">Open</a>() { <span class="keywordflow">return</span> provider.getStream(this.VirtualPath); }
<a name="l00297"></a>00297 
<a name="l00298"></a><a class="code" href="class_image_resizer_1_1_plugins_1_1_basic_1_1_virtual_folder_1_1_virtual_folder_provider_virtual_file.html#a6010f92de4ee6876ffb20d6f80df18cf">00298</a>             <span class="keyword">public</span> DateTime ModifiedDateUTC {
<a name="l00299"></a>00299                 <span class="keyword">get</span> {
<a name="l00300"></a>00300                     <span class="keywordflow">if</span> (_fileModifiedDate == null) _fileModifiedDate = provider.<a class="code" href="class_image_resizer_1_1_plugins_1_1_basic_1_1_virtual_folder.html#a7568a5fec26644bc3fc8e9c6c62e3d21" title="Returns the LastWriteTimeUtc value for the specified virtual file in this folder, or DateTime...">GetDateModifiedUtc</a>(this.VirtualPath);
<a name="l00301"></a>00301                     <span class="keywordflow">return</span> _fileModifiedDate.Value;
<a name="l00302"></a>00302                 }
<a name="l00303"></a>00303             }
<a name="l00304"></a>00304 
<a name="l00305"></a>00305         }
<a name="l00306"></a>00306 
<a name="l00307"></a>00307         <span class="keyword">public</span> IEnumerable&lt;IIssue&gt; GetIssues() {
<a name="l00308"></a>00308             List&lt;IIssue&gt; issues = <span class="keyword">new</span> List&lt;IIssue&gt;();
<a name="l00309"></a>00309 
<a name="l00310"></a>00310             <span class="keywordflow">if</span> (NoIOPermission) issues.Add(<span class="keyword">new</span> <a class="code" href="class_image_resizer_1_1_configuration_1_1_issues_1_1_issue.html">Issue</a>(<span class="stringliteral">&quot;The VirtualFolder plugin cannot serve files from \&quot;&quot;</span> +  PhysicalPath + <span class="stringliteral">&quot;\&quot; until you increase the trust level or modify the trust configuration to permit read access to the directory.&quot;</span>, <a class="code" href="namespace_image_resizer_1_1_configuration_1_1_issues.html#ada2af2a44c17c99a124cadb8a92f8555">IssueSeverity</a>.Error));
<a name="l00311"></a>00311             <span class="keywordflow">if</span> (FailedToRegisterVpp) issues.Add(<span class="keyword">new</span> <a class="code" href="class_image_resizer_1_1_configuration_1_1_issues_1_1_issue.html">Issue</a>(<span class="stringliteral">&quot;The VirtualFolder plugin failed to register itself as an app-wide VirtualPathProvider. It will only work for images proccessed by the image resizer.&quot;</span>, <a class="code" href="namespace_image_resizer_1_1_configuration_1_1_issues.html#ada2af2a44c17c99a124cadb8a92f8555">IssueSeverity</a>.Error));
<a name="l00312"></a>00312 
<a name="l00313"></a>00313 
<a name="l00314"></a>00314             <span class="keywordflow">return</span> issues;
<a name="l00315"></a>00315         }
<a name="l00316"></a>00316 
<a name="l00317"></a>00317     }
<a name="l00318"></a>00318 
<a name="l00319"></a>00319 }
<a name="l00320"></a>00320 
</pre></div></div><!-- contents -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Properties</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Events</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>



<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
