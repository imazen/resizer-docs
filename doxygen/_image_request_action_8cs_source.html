<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>ImageResizer: C:/Users/Administrator/Documents/resizer/Core.Mvc/ImageRequestAction.cs Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />

<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  <td id="projectlogo"><img alt="Logo" src="imageresizer-logo-00aec4.png"/></td>
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">ImageResizer
   &#160;<span id="projectnumber">3.3.3</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">C:/Users/Administrator/Documents/resizer/Core.Mvc/ImageRequestAction.cs</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 ï»¿using System;
<a name="l00002"></a>00002 <span class="keyword">using</span> System.Collections.Generic;
<a name="l00003"></a>00003 <span class="keyword">using</span> System.Linq;
<a name="l00004"></a>00004 <span class="keyword">using</span> System.Text;
<a name="l00005"></a>00005 <span class="keyword">using</span> System.Web.Mvc;
<a name="l00006"></a>00006 <span class="keyword">using</span> System.Collections.Specialized;
<a name="l00007"></a>00007 <span class="keyword">using</span> ImageResizer.Plugins;
<a name="l00008"></a>00008 <span class="keyword">using</span> ImageResizer.Configuration;
<a name="l00009"></a>00009 <span class="keyword">using</span> System.Web;
<a name="l00010"></a>00010 <span class="keyword">using</span> ImageResizer.Util;
<a name="l00011"></a>00011 <span class="keyword">using</span> System.Security.Principal;
<a name="l00012"></a>00012 <span class="keyword">using</span> System.Web.Security;
<a name="l00013"></a>00013 <span class="keyword">using</span> System.Web.Hosting;
<a name="l00014"></a>00014 <span class="keyword">using</span> System.Diagnostics;
<a name="l00015"></a>00015 <span class="keyword">using</span> ImageResizer.Plugins.Basic;
<a name="l00016"></a>00016 <span class="keyword">using</span> ImageResizer.Caching;
<a name="l00017"></a>00017 <span class="keyword">using</span> System.IO;
<a name="l00018"></a>00018 <span class="keyword">using</span> ImageResizer.Encoding;
<a name="l00019"></a>00019 <span class="keyword">using</span> ImageResizer.ExtensionMethods;
<a name="l00020"></a>00020 
<a name="l00021"></a><a class="code" href="namespace_image_resizer_1_1_mvc.html">00021</a> <span class="keyword">namespace </span>ImageResizer.Mvc {<span class="comment"></span>
<a name="l00022"></a>00022 <span class="comment">    /// &lt;summary&gt;</span>
<a name="l00023"></a>00023 <span class="comment">    /// This action result is NOT a replacement for the InterceptModule and MvcRoutingShim. It cannot hope to achieve the same performance, compatibility, or flexibility.</span>
<a name="l00024"></a>00024 <span class="comment">    /// It does not support all the plugins, nor all the Pipeline events. </span>
<a name="l00025"></a>00025 <span class="comment">    /// It does not support the CloudFront, Image404, or ImageHandlerSyntax plugins.  RemoteReader, SqlReader, S3Reader, , Image404, ClientCache, </span>
<a name="l00026"></a>00026 <span class="comment">    /// It doesn&#39;t even work yet.</span>
<a name="l00027"></a>00027 <span class="comment">    /// &lt;/summary&gt;</span>
<a name="l00028"></a><a class="code" href="class_image_resizer_1_1_mvc_1_1_image_request_action.html">00028</a> <span class="comment"></span>    <span class="keyword">internal</span> <span class="keyword">class </span><a class="code" href="class_image_resizer_1_1_mvc_1_1_image_request_action.html" title="This action result is NOT a replacement for the InterceptModule and MvcRoutingShim. It cannot hope to achieve the same performance, compatibility, or flexibility. It does not support all the plugins, nor all the Pipeline events. It does not support the CloudFront, Image404, or ImageHandlerSyntax plugins. RemoteReader, SqlReader, S3Reader, , Image404, ClientCache, It doesn&#39;t even work yet.">ImageRequestAction</a>: ActionResult {
<a name="l00029"></a>00029 
<a name="l00030"></a>00030         <span class="keyword">public</span> <a class="code" href="class_image_resizer_1_1_mvc_1_1_image_request_action.html" title="This action result is NOT a replacement for the InterceptModule and MvcRoutingShim. It cannot hope to achieve the same performance, compatibility, or flexibility. It does not support all the plugins, nor all the Pipeline events. It does not support the CloudFront, Image404, or ImageHandlerSyntax plugins. RemoteReader, SqlReader, S3Reader, , Image404, ClientCache, It doesn&#39;t even work yet.">ImageRequestAction</a>(<span class="keywordtype">string</span> virtualPath, NameValueCollection query, <a class="code" href="interface_image_resizer_1_1_configuration_1_1_i_pipeline_config.html">IPipelineConfig</a> conf = null) {
<a name="l00031"></a>00031             this.conf = (conf == null) ? <a class="code" href="class_image_resizer_1_1_configuration_1_1_config.html">Config</a>.<a class="code" href="class_image_resizer_1_1_configuration_1_1_config.html#a817438580b0b1f8dc08f4aa15e30f68d" title="Gets the current (app-wide) config instance.">Current</a>.<a class="code" href="class_image_resizer_1_1_configuration_1_1_config.html#ab7d8e32249817ef77f91508c087140d9" title="Access and modify settings related to the HttpModule pipline. Register URL rewriting hooks...">Pipeline</a> : conf;
<a name="l00032"></a>00032             ReauthorizeFinalPath = <span class="keyword">true</span>;
<a name="l00033"></a>00033             Source = virtualPath;
<a name="l00034"></a>00034             Settings = <span class="keyword">new</span> <a class="code" href="class_image_resizer_1_1_resize_settings.html" title="Represents the settings which will be used to process the image. Extends NameValueCollection to provi...">ResizeSettings</a>(query);
<a name="l00035"></a>00035         }
<a name="l00036"></a>00036 
<a name="l00037"></a>00037         <span class="keyword">protected</span> <a class="code" href="interface_image_resizer_1_1_configuration_1_1_i_pipeline_config.html">IPipelineConfig</a> conf = null;<span class="comment"></span>
<a name="l00038"></a>00038 <span class="comment">        /// &lt;summary&gt;</span>
<a name="l00039"></a>00039 <span class="comment">        /// If true, and if the app has Full Trust, the UrlAuthorizationModule will be run against the final virtual path before execution. Defaults to true.</span>
<a name="l00040"></a>00040 <span class="comment">        /// Pipeline.AuthorizeImage will be fired regardless.</span>
<a name="l00041"></a>00041 <span class="comment">        /// &lt;/summary&gt;</span>
<a name="l00042"></a><a class="code" href="class_image_resizer_1_1_mvc_1_1_image_request_action.html#a5ea9db75893a34ad3a99998a1096fe10">00042</a> <span class="comment"></span>        <span class="keyword">public</span> <span class="keywordtype">bool</span> ReauthorizeFinalPath{<span class="keyword">get</span>;<span class="keyword">set</span>;}
<a name="l00043"></a>00043 <span class="comment"></span>
<a name="l00044"></a>00044 <span class="comment">        /// &lt;summary&gt;</span>
<a name="l00045"></a>00045 <span class="comment">        /// The source object (Bitmap, path, stream, IVirtualFile, etc..) for the image to process and/or cache and/or serve.</span>
<a name="l00046"></a>00046 <span class="comment">        /// &lt;/summary&gt;</span>
<a name="l00047"></a><a class="code" href="class_image_resizer_1_1_mvc_1_1_image_request_action.html#a2b74c10414e2bb55df00a5cbd123beda">00047</a> <span class="comment"></span>        <span class="keyword">public</span> <span class="keywordtype">object</span> Source{<span class="keyword">get</span>;<span class="keyword">set</span>;}
<a name="l00048"></a>00048 <span class="comment"></span>
<a name="l00049"></a>00049 <span class="comment">        /// &lt;summary&gt;</span>
<a name="l00050"></a>00050 <span class="comment">        /// The resizing/processing commands to apply.</span>
<a name="l00051"></a>00051 <span class="comment">        /// &lt;/summary&gt;</span>
<a name="l00052"></a><a class="code" href="class_image_resizer_1_1_mvc_1_1_image_request_action.html#a58e301b4e60ebcf496d4f7a68a5c455f">00052</a> <span class="comment"></span>        <span class="keyword">public</span> <a class="code" href="class_image_resizer_1_1_resize_settings.html" title="Represents the settings which will be used to process the image. Extends NameValueCollection to provi...">ResizeSettings</a> Settings { <span class="keyword">get</span>; <span class="keyword">set</span>; }
<a name="l00053"></a>00053 
<a name="l00054"></a>00054         <span class="keyword">public</span> <a class="code" href="class_image_resizer_1_1_mvc_1_1_image_request_action.html" title="This action result is NOT a replacement for the InterceptModule and MvcRoutingShim. It cannot hope to achieve the same performance, compatibility, or flexibility. It does not support all the plugins, nor all the Pipeline events. It does not support the CloudFront, Image404, or ImageHandlerSyntax plugins. RemoteReader, SqlReader, S3Reader, , Image404, ClientCache, It doesn&#39;t even work yet.">ImageRequestAction</a>(<span class="keywordtype">object</span> source, NameValueCollection query, <span class="keywordtype">string</span> cachingKey, <a class="code" href="interface_image_resizer_1_1_configuration_1_1_i_pipeline_config.html">IPipelineConfig</a> conf = null) {
<a name="l00055"></a>00055             this.conf = (conf == null) ? <a class="code" href="class_image_resizer_1_1_configuration_1_1_config.html">Config</a>.<a class="code" href="class_image_resizer_1_1_configuration_1_1_config.html#a817438580b0b1f8dc08f4aa15e30f68d" title="Gets the current (app-wide) config instance.">Current</a>.<a class="code" href="class_image_resizer_1_1_configuration_1_1_config.html#ab7d8e32249817ef77f91508c087140d9" title="Access and modify settings related to the HttpModule pipline. Register URL rewriting hooks...">Pipeline</a> : conf;
<a name="l00056"></a>00056             <span class="keyword">this</span>.Source = source;
<a name="l00057"></a>00057             <span class="keyword">this</span>.Settings = <span class="keyword">new</span> <a class="code" href="class_image_resizer_1_1_resize_settings.html" title="Represents the settings which will be used to process the image. Extends NameValueCollection to provi...">ResizeSettings</a>(query);
<a name="l00058"></a>00058 
<a name="l00059"></a>00059         }
<a name="l00060"></a>00060 
<a name="l00061"></a>00061 
<a name="l00062"></a>00062         <span class="keyword">public</span> <span class="keyword">override</span> <span class="keywordtype">void</span> ExecuteResult(ControllerContext context) {
<a name="l00063"></a>00063             <span class="keywordflow">throw</span> <span class="keyword">new</span> NotImplementedException();
<a name="l00064"></a>00064             
<a name="l00065"></a>00065         }
<a name="l00066"></a>00066 <span class="comment"></span>
<a name="l00067"></a>00067 <span class="comment">        /// &lt;summary&gt;</span>
<a name="l00068"></a>00068 <span class="comment">        /// </span>
<a name="l00069"></a>00069 <span class="comment">        /// &lt;/summary&gt;</span>
<a name="l00070"></a>00070 <span class="comment">        /// &lt;param name=&quot;context&quot;&gt;&lt;/param&gt;</span>
<a name="l00071"></a>00071 <span class="comment">        /// &lt;param name=&quot;virtualPath&quot;&gt;&lt;/param&gt;</span>
<a name="l00072"></a>00072 <span class="comment">        /// &lt;param name=&quot;settings&quot;&gt;&lt;/param&gt;</span>
<a name="l00073"></a><a class="code" href="class_image_resizer_1_1_mvc_1_1_image_request_action.html#abe482e605822b9d79a19bff365e4b593">00073</a> <span class="comment"></span>        <span class="keyword">public</span> <span class="keywordtype">void</span> <a class="code" href="class_image_resizer_1_1_mvc_1_1_image_request_action.html#abe482e605822b9d79a19bff365e4b593">ExecuteVirtualPathResult</a>(ControllerContext context, <span class="keywordtype">string</span> virtualPath, NameValueCollection settings) {
<a name="l00074"></a>00074 
<a name="l00075"></a>00075             var app = (HttpApplication) context.HttpContext.GetService(typeof(HttpApplication));
<a name="l00076"></a>00076     
<a name="l00077"></a>00077             NameValueCollection q = settings;
<a name="l00078"></a>00078 
<a name="l00079"></a>00079             <span class="comment">//Call URL rewriting events</span>
<a name="l00080"></a>00080             <a class="code" href="class_image_resizer_1_1_configuration_1_1_url_event_args.html">UrlEventArgs</a> ue = <span class="keyword">new</span> <a class="code" href="class_image_resizer_1_1_configuration_1_1_url_event_args.html">UrlEventArgs</a>(virtualPath, q);
<a name="l00081"></a>00081             conf.FireRewritingEvents(null, app.Context,ue);
<a name="l00082"></a>00082 
<a name="l00083"></a>00083             <span class="comment">//Pull data back out of event object, resolving app-relative paths</span>
<a name="l00084"></a>00084             virtualPath = <a class="code" href="class_image_resizer_1_1_util_1_1_path_utils.html" title="A set of utility methods for manipulating virtual paths.">PathUtils</a>.<a class="code" href="class_image_resizer_1_1_util_1_1_path_utils.html#a1a7e4faaa93c5b4d1f3652ccfc4dae82" title="Turns relative paths into domain-relative paths. Turns app-relative paths into domain relative paths...">ResolveAppRelativeAssumeAppRelative</a>(ue.<a class="code" href="class_image_resizer_1_1_configuration_1_1_url_event_args.html#a45acfa52b457e3208a4c1442c12266fa" title="Domain-relative path which also includes the path info portion. I.e, &#39;/app/folder/file.aspx/path/info&#39; could be a valid value. Relative to the domain root, not the site or app root.">VirtualPath</a>);
<a name="l00085"></a>00085             q = ue.QueryString;
<a name="l00086"></a>00086 
<a name="l00087"></a>00087             <span class="comment">//Store the modified querystring in request for use by VirtualPathProviders</span>
<a name="l00088"></a>00088             conf.ModifiedQueryString = q;
<a name="l00089"></a>00089 
<a name="l00090"></a>00090             <span class="keywordtype">bool</span> isAllowed = <span class="keyword">true</span>;
<a name="l00091"></a>00091             <span class="keywordflow">if</span> (this.ReauthorizeFinalPath){
<a name="l00092"></a>00092                 <span class="comment">//Who&#39;s the user</span>
<a name="l00093"></a>00093                 IPrincipal user = app.Context.User as IPrincipal;
<a name="l00094"></a>00094                 <span class="comment">// no user (must be anonymous...).. Or authentication doesn&#39;t work for this suffix. Whatever, just avoid a nullref in the UrlAuthorizationModule</span>
<a name="l00095"></a>00095                 <span class="keywordflow">if</span> (user == null)  user = <span class="keyword">new</span> GenericPrincipal(<span class="keyword">new</span> GenericIdentity(<span class="keywordtype">string</span>.Empty, <span class="keywordtype">string</span>.Empty), <span class="keyword">new</span> <span class="keywordtype">string</span>[0]);
<a name="l00096"></a>00096                 <span class="comment">//Do we have permission to call UrlAuthorizationModule.CheckUrlAccessForPrincipal?</span>
<a name="l00097"></a>00097                 <span class="keywordtype">bool</span> canCheckUrl = System.Security.SecurityManager.IsGranted(<span class="keyword">new</span> System.Security.Permissions.SecurityPermission(System.Security.Permissions.PermissionState.Unrestricted));
<a name="l00098"></a>00098                 <span class="comment">//Run the rewritten path past the auth system again, using the result as the default &quot;AllowAccess&quot; value</span>
<a name="l00099"></a>00099                 <span class="keywordflow">if</span> (canCheckUrl) <span class="keywordflow">try</span> {
<a name="l00100"></a>00100                             isAllowed = UrlAuthorizationModule.CheckUrlAccessForPrincipal(virtualPath, user, <span class="stringliteral">&quot;GET&quot;</span>);
<a name="l00101"></a>00101                         } <span class="keywordflow">catch</span> (NotImplementedException) { } <span class="comment">//For MONO support</span>
<a name="l00102"></a>00102 
<a name="l00103"></a>00103             }
<a name="l00104"></a>00104                  
<a name="l00105"></a>00105             <span class="comment">//Allow user code to deny access, but not modify the url or querystring.</span>
<a name="l00106"></a>00106             <a class="code" href="interface_image_resizer_1_1_configuration_1_1_i_url_authorization_event_args.html">IUrlAuthorizationEventArgs</a> authEvent = <span class="keyword">new</span> <a class="code" href="class_image_resizer_1_1_configuration_1_1_url_authorization_event_args.html">UrlAuthorizationEventArgs</a>(virtualPath, <span class="keyword">new</span> NameValueCollection(q), isAllowed);
<a name="l00107"></a>00107             conf.FireAuthorizeImage(null, app.Context, authEvent);
<a name="l00108"></a>00108 
<a name="l00109"></a>00109             <span class="keywordflow">if</span> (!authEvent.AllowAccess) <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="class_image_resizer_1_1_image_processing_exception.html" title="Represents an non-recoverable exception that occured while processing the image. Possible causes are:...">ImageProcessingException</a>(403, <span class="stringliteral">&quot;Access denied&quot;</span>, <span class="stringliteral">&quot;Access denied&quot;</span>);
<a name="l00110"></a>00110 
<a name="l00111"></a>00111                     
<a name="l00112"></a>00112                     
<a name="l00113"></a>00113             <span class="comment">//Does the file exist physically? (false if VppUsage=always or file is missing)</span>
<a name="l00114"></a>00114             <span class="keywordtype">bool</span> existsPhysically = (conf.VppUsage != VppUsageOption.Always) &amp;&amp; System.IO.File.Exists(HostingEnvironment.MapPath(virtualPath));
<a name="l00115"></a>00115 
<a name="l00116"></a>00116             <span class="comment">//If not present physically (and VppUsage!=never), try to get the virtual file. Null indicates a missing file</span>
<a name="l00117"></a>00117             <a class="code" href="interface_image_resizer_1_1_plugins_1_1_i_virtual_file.html" title="A virtual file to support IVirtualImageProvider.">IVirtualFile</a> vf = (conf.VppUsage != VppUsageOption.Never &amp;&amp; !existsPhysically) ? conf.GetFile(virtualPath, q) : null;
<a name="l00118"></a>00118 
<a name="l00119"></a>00119             <span class="comment">//Only process files that exist</span>
<a name="l00120"></a>00120             <span class="keywordflow">if</span> (existsPhysically || vf != null) {
<a name="l00121"></a>00121                 <span class="keywordflow">try</span>{
<a name="l00122"></a>00122                     ExecuteVirtualFileResult(app.Context, virtualPath, q, vf);
<a name="l00123"></a>00123                     <span class="comment">//Catch not found exceptions</span>
<a name="l00124"></a>00124                 } <span class="keywordflow">catch</span> (System.IO.FileNotFoundException notFound) { <span class="comment">//Some VPPs are optimisitic , or could be a race condition</span>
<a name="l00125"></a>00125                     FileMissing(app.Context, virtualPath, q);
<a name="l00126"></a>00126                     <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="class_image_resizer_1_1_image_missing_exception.html" title="One or more source files was missing.">ImageMissingException</a>(<span class="stringliteral">&quot;The specified resource could not be located&quot;</span>, <span class="stringliteral">&quot;File not found&quot;</span>, notFound);
<a name="l00127"></a>00127                 }
<a name="l00128"></a>00128             } <span class="keywordflow">else</span>
<a name="l00129"></a>00129                 FileMissing(app.Context, virtualPath, q);
<a name="l00130"></a>00130 
<a name="l00131"></a>00131         }
<a name="l00132"></a>00132 
<a name="l00133"></a>00133         <span class="comment"></span>
<a name="l00134"></a>00134 <span class="comment">        /// &lt;summary&gt;</span>
<a name="l00135"></a>00135 <span class="comment">        /// </span>
<a name="l00136"></a>00136 <span class="comment">        /// Generates the resized image to disk (if needed), then rewrites the request to that location.</span>
<a name="l00137"></a>00137 <span class="comment">        /// Perform 404 checking before calling this method. Assumes file exists.</span>
<a name="l00138"></a>00138 <span class="comment">        /// Called during PostAuthorizeRequest</span>
<a name="l00139"></a>00139 <span class="comment">        /// &lt;/summary&gt;</span>
<a name="l00140"></a>00140 <span class="comment">        /// &lt;param name=&quot;context&quot;&gt;&lt;/param&gt;</span>
<a name="l00141"></a>00141 <span class="comment">        /// &lt;param name=&quot;virtualPath&quot;&gt;&lt;/param&gt;</span>
<a name="l00142"></a>00142 <span class="comment">                /// &lt;param name=&quot;queryString&quot;&gt;&lt;/param&gt;</span>
<a name="l00143"></a>00143 <span class="comment">                /// &lt;param name=&quot;vf&quot;&gt;&lt;/param&gt;</span>
<a name="l00144"></a><a class="code" href="class_image_resizer_1_1_mvc_1_1_image_request_action.html#a89878ee2f86eb865caf2e1ecc15773e1">00144</a> <span class="comment"></span>        <span class="keyword">public</span> <span class="keywordtype">void</span> <a class="code" href="class_image_resizer_1_1_mvc_1_1_image_request_action.html#a89878ee2f86eb865caf2e1ecc15773e1" title="Generates the resized image to disk (if needed), then rewrites the request to that location...">ExecuteVirtualFileResult</a>(HttpContext context, <span class="keywordtype">string</span> virtualPath, NameValueCollection queryString, <a class="code" href="interface_image_resizer_1_1_plugins_1_1_i_virtual_file.html" title="A virtual file to support IVirtualImageProvider.">IVirtualFile</a> vf) {
<a name="l00145"></a>00145             Stopwatch s = <span class="keyword">new</span> Stopwatch();
<a name="l00146"></a>00146             s.Start();
<a name="l00147"></a>00147             
<a name="l00148"></a>00148 
<a name="l00149"></a>00149             <a class="code" href="class_image_resizer_1_1_resize_settings.html" title="Represents the settings which will be used to process the image. Extends NameValueCollection to provi...">ResizeSettings</a> settings = <span class="keyword">new</span> <a class="code" href="class_image_resizer_1_1_resize_settings.html" title="Represents the settings which will be used to process the image. Extends NameValueCollection to provi...">ResizeSettings</a>(queryString);
<a name="l00150"></a>00150 
<a name="l00151"></a>00151             <span class="keywordtype">bool</span> isCaching = settings.<a class="code" href="class_image_resizer_1_1_resize_settings.html#a4522fd631e051dc79ea2615168db0d71" title="[&quot;cache&quot;]: Server caching mode suggestion for the result">Cache</a> == <a class="code" href="namespace_image_resizer.html#a6b30c95c789b77db2c5aa905345d917c" title="When to disk cache the image.">ServerCacheMode</a>.Always;
<a name="l00152"></a>00152             <span class="keywordtype">bool</span> isProcessing = settings.<a class="code" href="class_image_resizer_1_1_resize_settings.html#ad3807eb3cc2f2f4caf557c44c310cb22" title="[&quot;process&quot;]: Server processing suggestion for the result. Allows you to &#39;disable&#39; processing of the...">Process</a> == <a class="code" href="namespace_image_resizer.html#a089c1fb717c880fab9cb6c06a06cf35a" title="When to process and re-encode the file.">ProcessWhen</a>.Always;
<a name="l00153"></a>00153 
<a name="l00154"></a>00154             <span class="comment">//By default, we process it if is both (a) a recognized image extension, and (b) has a resizing directive (not just &#39;cache&#39;).</span>
<a name="l00155"></a>00155             <span class="keywordflow">if</span> (settings.<a class="code" href="class_image_resizer_1_1_resize_settings.html#ad3807eb3cc2f2f4caf557c44c310cb22" title="[&quot;process&quot;]: Server processing suggestion for the result. Allows you to &#39;disable&#39; processing of the...">Process</a> == <a class="code" href="namespace_image_resizer.html#a089c1fb717c880fab9cb6c06a06cf35a" title="When to process and re-encode the file.">ProcessWhen</a>.Default){
<a name="l00156"></a>00156                 <span class="comment">//Check for resize directive by removing (&#39;non-resizing&#39; items from the current querystring) </span>
<a name="l00157"></a>00157                 NameValueCollection copy = <span class="keyword">new</span> NameValueCollection(queryString);
<a name="l00158"></a>00158                 copy.Remove(<span class="stringliteral">&quot;cache&quot;</span>); copy.Remove(<span class="stringliteral">&quot;process&quot;</span>); copy.Remove(<span class="stringliteral">&quot;useresizingpipeline&quot;</span>); copy.Remove(<span class="stringliteral">&quot;404&quot;</span>);
<a name="l00159"></a>00159                 <span class="comment">//If the &#39;copy&#39; still has directives, and it&#39;s an image request, then let&#39;s process it.</span>
<a name="l00160"></a>00160                 isProcessing = conf.IsAcceptedImageType(virtualPath) &amp;&amp;  conf.HasPipelineDirective(copy);
<a name="l00161"></a>00161             }
<a name="l00162"></a>00162 
<a name="l00163"></a>00163             <span class="comment">//By default, we only cache it if we&#39;re processing it. </span>
<a name="l00164"></a>00164             <span class="keywordflow">if</span> (settings.<a class="code" href="class_image_resizer_1_1_resize_settings.html#a4522fd631e051dc79ea2615168db0d71" title="[&quot;cache&quot;]: Server caching mode suggestion for the result">Cache</a> == <a class="code" href="namespace_image_resizer.html#a6b30c95c789b77db2c5aa905345d917c" title="When to disk cache the image.">ServerCacheMode</a>.Default &amp;&amp; isProcessing) 
<a name="l00165"></a>00165                 isCaching = <span class="keyword">true</span>;
<a name="l00166"></a>00166 
<a name="l00167"></a>00167             <span class="comment">//Resolve the &#39;cache&#39; setting to &#39;no&#39; unless we want it cache.</span>
<a name="l00168"></a>00168             <span class="keywordflow">if</span> (!isCaching) settings.<a class="code" href="class_image_resizer_1_1_resize_settings.html#a4522fd631e051dc79ea2615168db0d71" title="[&quot;cache&quot;]: Server caching mode suggestion for the result">Cache</a> = <a class="code" href="namespace_image_resizer.html#a6b30c95c789b77db2c5aa905345d917c" title="When to disk cache the image.">ServerCacheMode</a>.No;
<a name="l00169"></a>00169 
<a name="l00170"></a>00170             context.Items[conf.ResponseArgsKey] = <span class="stringliteral">&quot;&quot;</span>; <span class="comment">//We are handling the request</span>
<a name="l00171"></a>00171 
<a name="l00172"></a>00172 
<a name="l00173"></a>00173             <span class="comment">//Find out if we have a modified date that we can work with</span>
<a name="l00174"></a>00174             <span class="keywordtype">bool</span> hasModifiedDate = (vf == null) || vf is <a class="code" href="interface_image_resizer_1_1_plugins_1_1_i_virtual_file_with_modified_date.html" title="Always implement this if possible. Allows caching systems to detect changes to source files and inval...">IVirtualFileWithModifiedDate</a>;
<a name="l00175"></a>00175             DateTime modDate = DateTime.MinValue;
<a name="l00176"></a>00176             <span class="keywordflow">if</span> (hasModifiedDate &amp;&amp; vf != null) {
<a name="l00177"></a>00177                 modDate = ((<a class="code" href="interface_image_resizer_1_1_plugins_1_1_i_virtual_file_with_modified_date.html" title="Always implement this if possible. Allows caching systems to detect changes to source files and inval...">IVirtualFileWithModifiedDate</a>)vf).<a class="code" href="interface_image_resizer_1_1_plugins_1_1_i_virtual_file_with_modified_date.html#a8b36a63342e1e41f82628a8cb4ce482b" title="The modified (last write time) of the source file, in UTC form.">ModifiedDateUTC</a>;
<a name="l00178"></a>00178                 <span class="keywordflow">if</span> (modDate == DateTime.MinValue || modDate == DateTime.MaxValue) {
<a name="l00179"></a>00179                     hasModifiedDate = <span class="keyword">false</span>; <span class="comment">//Skip modified date checking if the file has no modified date</span>
<a name="l00180"></a>00180                 }
<a name="l00181"></a>00181             }
<a name="l00182"></a>00182 
<a name="l00183"></a>00183 
<a name="l00184"></a>00184             <a class="code" href="interface_image_resizer_1_1_encoding_1_1_i_encoder.html" title="An image encoder. Exposes methods for suitability checking, encoding, transparency compatibility chec...">IEncoder</a> guessedEncoder = null;
<a name="l00185"></a>00185             <span class="comment">//Only use an encoder to determine extension/mime-type when it&#39;s an image extension or when we&#39;ve set process = always.</span>
<a name="l00186"></a>00186             <span class="keywordflow">if</span> (isProcessing) {
<a name="l00187"></a>00187                 guessedEncoder = conf.GetImageBuilder().EncoderProvider.GetEncoder(settings, virtualPath);
<a name="l00188"></a>00188                 <span class="keywordflow">if</span> (guessedEncoder == null) <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="class_image_resizer_1_1_image_processing_exception.html" title="Represents an non-recoverable exception that occured while processing the image. Possible causes are:...">ImageProcessingException</a>(<span class="stringliteral">&quot;Image Resizer: No image encoder was found for the request.&quot;</span>);
<a name="l00189"></a>00189             }
<a name="l00190"></a>00190 
<a name="l00191"></a>00191             <span class="comment">//Determine the file extenson for the caching system to use if we aren&#39;t processing the image</span>
<a name="l00192"></a>00192             <span class="comment">//Use the exsiting one if is an image extension. If not, use &quot;unknown&quot;. </span>
<a name="l00193"></a>00193             <span class="comment">// We don&#39;t want to suggest writing .exe or .aspx files to the cache! </span>
<a name="l00194"></a>00194             <span class="keywordtype">string</span> fallbackExtension = <a class="code" href="class_image_resizer_1_1_util_1_1_path_utils.html" title="A set of utility methods for manipulating virtual paths.">PathUtils</a>.<a class="code" href="class_image_resizer_1_1_util_1_1_path_utils.html#a3b381221fbb1e4bd0d5d299c7f0dc550" title="Will return the full extension, like &quot;.jpg.ashx&quot;, not just the last bit. Excludes extensions containi...">GetFullExtension</a>(virtualPath).TrimStart(<span class="charliteral">&#39;.&#39;</span>); 
<a name="l00195"></a>00195             <span class="keywordflow">if</span> (!conf.IsAcceptedImageType(virtualPath)) fallbackExtension = <span class="stringliteral">&quot;unknown&quot;</span>;
<a name="l00196"></a>00196 
<a name="l00197"></a>00197             <span class="comment">//Determine the mime-type if we aren&#39;t processing the image.</span>
<a name="l00198"></a>00198             <span class="keywordtype">string</span> fallbackContentType = <span class="stringliteral">&quot;application/octet-stream&quot;</span>;
<a name="l00199"></a>00199             <span class="comment">//Support jpeg, png, gif, bmp, tiff mime-types. Otherwise use &quot;application/octet-stream&quot;. </span>
<a name="l00200"></a>00200             <span class="comment">//We can&#39;t set it to null - it will default to text/html</span>
<a name="l00201"></a>00201             System.Drawing.Imaging.ImageFormat recognizedExtension = <a class="code" href="class_image_resizer_1_1_plugins_1_1_basic_1_1_default_encoder.html" title="Provides basic encoding functionality for Jpeg, png, and gif output. Allows adjustable Jpeg compressi...">DefaultEncoder</a>.<a class="code" href="class_image_resizer_1_1_plugins_1_1_basic_1_1_default_encoder.html#a0a8c27e25a65aba24098a7f70dc09f2e" title="Returns an ImageFormat instance from the specfied file extension. Extensions lie sometimes, just a guess. returns null if not recognized.">GetImageFormatFromExtension</a>(fallbackExtension);
<a name="l00202"></a>00202             <span class="keywordflow">if</span> (recognizedExtension != null) fallbackContentType = <a class="code" href="class_image_resizer_1_1_plugins_1_1_basic_1_1_default_encoder.html" title="Provides basic encoding functionality for Jpeg, png, and gif output. Allows adjustable Jpeg compressi...">DefaultEncoder</a>.<a class="code" href="class_image_resizer_1_1_plugins_1_1_basic_1_1_default_encoder.html#ab609bf99180cd6f3c94ef111be799fc8" title="Supports Png, Jpeg, Gif, Bmp, and Tiff. Throws a ArgumentOutOfRangeException if not png...">GetContentTypeFromImageFormat</a>(recognizedExtension);
<a name="l00203"></a>00203 
<a name="l00204"></a>00204 
<a name="l00205"></a>00205             <span class="comment">//Build CacheEventArgs</span>
<a name="l00206"></a>00206             <a class="code" href="class_image_resizer_1_1_caching_1_1_response_args.html" title="IResponseArgs implementation.">ResponseArgs</a> e = <span class="keyword">new</span> <a class="code" href="class_image_resizer_1_1_caching_1_1_response_args.html" title="IResponseArgs implementation.">ResponseArgs</a>();
<a name="l00207"></a>00207             e.<a class="code" href="class_image_resizer_1_1_caching_1_1_response_args.html#a9a37ba30bcff0b537af5ac405c5b5a3e" title="A value derived from the request. Can be used as a cache key.">RequestKey</a> = virtualPath + <a class="code" href="class_image_resizer_1_1_util_1_1_path_utils.html" title="A set of utility methods for manipulating virtual paths.">PathUtils</a>.<a class="code" href="class_image_resizer_1_1_util_1_1_path_utils.html#ac50e452cbcb5cea21318669c89632755" title="Returns a string querystring in the form &quot;?key=value&amp;amp;key=value&quot;. Keys and values are UrlEncoded a...">BuildQueryString</a>(queryString);
<a name="l00208"></a>00208             e.<a class="code" href="class_image_resizer_1_1_caching_1_1_response_args.html#a0708450cd35b10e284c1a45b0ca3abc1" title="The rewritten querystring. Can be useful for caching systems that accept querystring arguments...">RewrittenQuerystring</a> = settings;
<a name="l00209"></a>00209             e.<a class="code" href="class_image_resizer_1_1_caching_1_1_response_args.html#a486726072eda5c0872cd117e6913c0a4" title="The content-type of the data, among other things. Set ResponseHeaders.ApplyDuringPreSendRequestHeader...">ResponseHeaders</a>.<a class="code" href="interface_image_resizer_1_1_caching_1_1_i_response_headers.html#a0e2048699acfd1ec7b5d4657116e38de" title="The mime-type of the output data. Defaults to null.">ContentType</a> = isProcessing ? guessedEncoder.<a class="code" href="interface_image_resizer_1_1_encoding_1_1_i_encoder.html#a7cbe10dac3c2bad04d088ae6f20e4180" title="Returns the appropriate mime-time for the output format as currently configured.">MimeType</a> : fallbackContentType; 
<a name="l00210"></a>00210             e.<a class="code" href="class_image_resizer_1_1_caching_1_1_response_args.html#a14024965db082abfd3d917db64d4fc8d" title="A file extension appropriate for the resulting data. May be different than the extension on the origi...">SuggestedExtension</a> = isProcessing ? guessedEncoder.<a class="code" href="interface_image_resizer_1_1_encoding_1_1_i_encoder.html#ad7da126e6577cc319df398bf04949859" title="Returns a file extension appropriate for the output format as currently configured, without a leading dot.">Extension</a> : fallbackExtension;
<a name="l00211"></a>00211             e.<a class="code" href="class_image_resizer_1_1_caching_1_1_response_args.html#ae5ba046b9a32027352393bdd428b20e8" title="True if the source file/record has a modified date.">HasModifiedDate</a> = hasModifiedDate;
<a name="l00212"></a>00212             <span class="comment">//Add delegate for retrieving the modified date of the source file. </span>
<a name="l00213"></a>00213             e.<a class="code" href="class_image_resizer_1_1_caching_1_1_response_args.html#aa04d4cdaa9c276e0efba59d83c85cf9e" title="A callback method to return the last modified date of the source file if available, or DateTime.MinValue if not.">GetModifiedDateUTC</a> = <span class="keyword">new</span> <a class="code" href="namespace_image_resizer_1_1_caching.html#aa07f9e07e851742ccee15c9caf69c1ba" title="A callback method to return the last modified date of the source file if available, or DateTime.MinValue if not available.">ModifiedDateDelegate</a>(delegate() {
<a name="l00214"></a>00214                 <span class="keywordflow">if</span> (vf == null)
<a name="l00215"></a>00215                     <span class="keywordflow">return</span> System.IO.File.GetLastWriteTimeUtc(HostingEnvironment.MapPath(virtualPath));
<a name="l00216"></a>00216                 <span class="keywordflow">else</span> <span class="keywordflow">if</span> (hasModifiedDate)
<a name="l00217"></a>00217                     <span class="keywordflow">return</span> modDate;
<a name="l00218"></a>00218                 <span class="keywordflow">else</span> <span class="keywordflow">return</span> DateTime.MinValue; <span class="comment">//Won&#39;t be called, no modified date available.</span>
<a name="l00219"></a>00219             });
<a name="l00220"></a>00220 
<a name="l00221"></a>00221             <span class="comment">//Add delegate for writing the data stream</span>
<a name="l00222"></a>00222             e.<a class="code" href="class_image_resizer_1_1_caching_1_1_response_args.html#a86f8e5a78c888c1944f3b39d0007b24b" title="A callback method that will resize and encode the image into a stream.">ResizeImageToStream</a> = <span class="keyword">new</span> <a class="code" href="namespace_image_resizer_1_1_caching.html#a51e885e7bc7d9c3c6906b6d51baad126" title="A callback method that will resize, encode, and write the data to the given stream. Callback may throw FileNotFoundException when running on top of an optimistic VPP.">ResizeImageDelegate</a>(delegate(System.IO.Stream stream) {
<a name="l00223"></a>00223                 <span class="comment">//This runs on a cache miss or cache invalid. This delegate is preventing from running in more</span>
<a name="l00224"></a>00224                 <span class="comment">//than one thread at a time for the specified cache key</span>
<a name="l00225"></a>00225                 <span class="keywordflow">try</span> {
<a name="l00226"></a>00226                     if (!isProcessing) {
<a name="l00227"></a>00227                         <span class="comment">//Just duplicate the data</span>
<a name="l00228"></a>00228                         <span class="keyword">using</span> (Stream source = (vf != null) ? vf.<a class="code" href="interface_image_resizer_1_1_plugins_1_1_i_virtual_file.html#ab7b7a83101de09de66b663910b3febcc" title="Returns an opened stream to the file contents.">Open</a>(): 
<a name="l00229"></a>00229                                         File.Open(HostingEnvironment.MapPath(virtualPath), FileMode.Open, FileAccess.Read, FileShare.Read)) {
<a name="l00230"></a>00230                                             <a class="code" href="class_image_resizer_1_1_extension_methods_1_1_stream_extensions.html" title="Provides extension methods for copying streams.">StreamExtensions</a>.<a class="code" href="class_image_resizer_1_1_extension_methods_1_1_stream_extensions.html#a55239e9e68fb5bac89151a57e189d8de" title="Copies the remaining data from the this stream into the given stream.">CopyToStream</a>(source, stream);
<a name="l00231"></a>00231                         }
<a name="l00232"></a>00232                     } <span class="keywordflow">else</span> {
<a name="l00233"></a>00233                         <span class="comment">//Process the image</span>
<a name="l00234"></a>00234                         <span class="keywordflow">if</span> (vf != null)
<a name="l00235"></a>00235                             conf.GetImageBuilder().Build(vf, stream, settings);
<a name="l00236"></a>00236                         <span class="keywordflow">else</span>
<a name="l00237"></a>00237                             conf.GetImageBuilder().Build(HostingEnvironment.MapPath(virtualPath), stream, settings); <span class="comment">//Use a physical path to bypass virtual file system</span>
<a name="l00238"></a>00238                     }
<a name="l00239"></a>00239 
<a name="l00240"></a>00240                     <span class="comment">//Catch not found exceptions</span>
<a name="l00241"></a>00241                 } <span class="keywordflow">catch</span> (System.IO.FileNotFoundException notFound) {
<a name="l00242"></a>00242                     <span class="comment">//This will be called later, if at all. </span>
<a name="l00243"></a>00243                     FileMissing(context, virtualPath, queryString);
<a name="l00244"></a>00244                     <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="class_image_resizer_1_1_image_missing_exception.html" title="One or more source files was missing.">ImageMissingException</a>(<span class="stringliteral">&quot;The specified resource could not be located&quot;</span>,<span class="stringliteral">&quot;File not found&quot;</span>, notFound);
<a name="l00245"></a>00245                 }
<a name="l00246"></a>00246             });
<a name="l00247"></a>00247 
<a name="l00248"></a>00248 
<a name="l00249"></a>00249             context.Items[conf.ResponseArgsKey] = e; <span class="comment">//store in context items</span>
<a name="l00250"></a>00250 
<a name="l00251"></a>00251             <span class="comment">//Fire events (for client-side caching plugins)</span>
<a name="l00252"></a>00252             conf.FirePreHandleImage(null, context, e);
<a name="l00253"></a>00253 
<a name="l00254"></a>00254             <span class="comment">//Pass the rest of the work off to the caching module. It will handle rewriting/redirecting and everything. </span>
<a name="l00255"></a>00255             <span class="comment">//We handle request headers based on what is found in context.Items</span>
<a name="l00256"></a>00256             <a class="code" href="interface_image_resizer_1_1_caching_1_1_i_cache.html" title="Provides caching behavior.">ICache</a> cache = conf.GetCacheProvider().GetCachingSystem(context, e);
<a name="l00257"></a>00257 
<a name="l00258"></a>00258             <span class="comment">//Verify we have a caching system</span>
<a name="l00259"></a>00259             <span class="keywordflow">if</span> (cache == null) <span class="keywordflow">throw</span> <span class="keyword">new</span> ImageProcessingException(<span class="stringliteral">&quot;Image Resizer: No caching plugin was found for the request&quot;</span>);
<a name="l00260"></a>00260             
<a name="l00261"></a>00261             <span class="keywordflow">if</span> (cache is <a class="code" href="class_image_resizer_1_1_plugins_1_1_basic_1_1_no_cache.html" title="Default cache when DiskCache isn&#39;t installed. Useful for debugging purposes but unsuited for producti...">NoCache</a>){
<a name="l00262"></a>00262             }<span class="keywordflow">else</span>{
<a name="l00263"></a>00263             }
<a name="l00264"></a>00264             
<a name="l00265"></a>00265 
<a name="l00266"></a>00266             s.Stop();
<a name="l00267"></a>00267             context.Items[<span class="stringliteral">&quot;ResizingTime&quot;</span>] = s.ElapsedMilliseconds;
<a name="l00268"></a>00268 
<a name="l00269"></a>00269         }
<a name="l00270"></a>00270 
<a name="l00271"></a>00271 
<a name="l00272"></a>00272          <span class="keyword">protected</span> <span class="keywordtype">void</span> FileMissing(HttpContext httpContext, <span class="keywordtype">string</span> virtualPath, NameValueCollection q) {
<a name="l00273"></a>00273             <span class="comment">//Fire the event (for default image redirection, etc) </span>
<a name="l00274"></a>00274             conf.FireImageMissing(null, httpContext, <span class="keyword">new</span> <a class="code" href="class_image_resizer_1_1_configuration_1_1_url_event_args.html">UrlEventArgs</a>( virtualPath, <span class="keyword">new</span> NameValueCollection(q)));
<a name="l00275"></a>00275 
<a name="l00276"></a>00276             <span class="comment">//Remove the image from context items so we don&#39;t try to write response headers.</span>
<a name="l00277"></a>00277             httpContext.Items[conf.ResponseArgsKey] = null;
<a name="l00278"></a>00278          }
<a name="l00279"></a>00279 
<a name="l00280"></a>00280         <span class="comment">/* To support S3Reader properly, we need to cache unprocessed images: </span>
<a name="l00281"></a>00281 <span class="comment">         * </span>
<a name="l00282"></a>00282 <span class="comment">        void Pipeline_RewriteDefaults(System.Web.IHttpModule sender, System.Web.HttpContext context, Configuration.IUrlEventArgs e) {</span>
<a name="l00283"></a>00283 <span class="comment">            //Always request caching for this VPP. Will not override existing values.</span>
<a name="l00284"></a>00284 <span class="comment">            if (vpp.IsPathVirtual(e.VirtualPath)) e.QueryString[&quot;cache&quot;] = ServerCacheMode.Always.ToString();</span>
<a name="l00285"></a>00285 <span class="comment">        }*/</span>
<a name="l00286"></a>00286         <span class="comment">/* To support SqlReader properly, we need to skip file type checks when requested, cache unmodified files, and reencode data when requested.</span>
<a name="l00287"></a>00287 <span class="comment">         * </span>
<a name="l00288"></a>00288 <span class="comment">                };</span>
<a name="l00289"></a>00289 <span class="comment">         */</span>
<a name="l00290"></a>00290 
<a name="l00291"></a>00291 
<a name="l00292"></a>00292     }
<a name="l00293"></a>00293 }
</pre></div></div><!-- contents -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Properties</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Events</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>



<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
